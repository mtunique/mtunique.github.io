<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>【Spark笔记】基本概念 | mtunique blog</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="【Spark笔记】基本概念"><meta property="og:description" content="代码量 Spark: 20,000 LOC
Hadoop 1.0: 90,000 LOC
Hadoop 2.0: 220,000 LOC
基本概念 RDD - resillient distributed dataset 弹性分布式数据集
Operation - 作用于RDD的各种操作分为transformation和action
Job - 作业，一个JOB包含多个RDD及作用于相应RDD上的各种operation
Stage - 一个作业分为多个阶段
Partition - 数据分区， 一个RDD中的数据可以分成多个不同的区
DAG - Directed Acycle graph, 有向无环图，反应RDD之间的依赖关系
Narrow dependency - 窄依赖，子RDD依赖于父RDD中固定的data partition
Wide Dependency - 宽依赖，子RDD对父RDD中的所有data partition都有依赖
Caching Managenment - 缓存管理，对RDD的中间计算结果进行缓存管理以加快整体的处理速度
这些基本概念会反复提到
编程模型 Spark应用程序可分两部分：driver部分和executor部分初始化SparkContext和主体程序
A：driver部分 driver部分主要是对SparkContext进行配置、初始化以及关闭。初始化SparkContext是为了构建Spark应用程序的运行环境，在初始化SparkContext，要先导入一些Spark的类和隐式转换；在executor部分运行完毕后，需要将SparkContext关闭。
B：executor部分 Spark应用程序的executor部分是对数据的处理，数据分三种：
原生数据 包含输入的数据和输出的数据。
输入原生数据  scala集合数据集，如Array(1,2,3,4,5)，Spark使用parallelize方法转换成RDD。 hadoop数据集，Spark支持存储在hadoop上的文件和hadoop支持的其他文件系统，如本地文件、HBase、SequenceFile和Hadoop的输入格式。例如Spark使用txtFile方法可以将本地文件或HDFS文件转换成RDD.  输出数据  生成Scala标量数据，如count（返回RDD中元素的个数）、reduce、fold/aggregate；返回几个标量，如take（返回前几个元素）。 生成Scala集合数据集，如collect（把RDD中的所有元素倒入 Scala集合类型）、lookup（查找对应key的所有值）。 生成hadoop数据集，如saveAsTextFile、saveAsSequenceFile  RDD(Resilient Distributed Datasets) 是一个容错的、并行的数据结构，可以让用户显式地将数据存储到磁盘和内存中，并能控制数据的分区。同时，RDD还提供了一组丰富的操作来操作这些数据。在这些操作中，诸如map、flatMap、filter等转换操作实现了monad模式，很好地契合了Scala的集合操作。除此之外，RDD还提供了诸如join、groupBy、reduceByKey等更为方便的操作（注意，reduceByKey是action，而非transformation），以支持常见的数据运算。 RDD作为数据结构，本质上是一个只读的分区记录集合。一个RDD可以包含多个分区，每个分区就是一个dataset片段。RDD可以相互依赖。如果RDD的每个分区最多只能被一个Child RDD的一个分区使用，则称之为narrow dependency；若多个Child RDD分区都可以依赖，则称之为wide dependency。不同的操作依据其特性，可能会产生不同的依赖。例如map操作会产生narrow dependency，而join操作则产生wide dependency。"><meta property="og:type" content="article"><meta property="og:url" content="https://mtunique.com/posts/spark_base/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-11-28T13:30:27+08:00"><meta property="article:modified_time" content="2014-11-28T13:30:27+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="【Spark笔记】基本概念"><meta name=twitter:description content="代码量 Spark: 20,000 LOC
Hadoop 1.0: 90,000 LOC
Hadoop 2.0: 220,000 LOC
基本概念 RDD - resillient distributed dataset 弹性分布式数据集
Operation - 作用于RDD的各种操作分为transformation和action
Job - 作业，一个JOB包含多个RDD及作用于相应RDD上的各种operation
Stage - 一个作业分为多个阶段
Partition - 数据分区， 一个RDD中的数据可以分成多个不同的区
DAG - Directed Acycle graph, 有向无环图，反应RDD之间的依赖关系
Narrow dependency - 窄依赖，子RDD依赖于父RDD中固定的data partition
Wide Dependency - 宽依赖，子RDD对父RDD中的所有data partition都有依赖
Caching Managenment - 缓存管理，对RDD的中间计算结果进行缓存管理以加快整体的处理速度
这些基本概念会反复提到
编程模型 Spark应用程序可分两部分：driver部分和executor部分初始化SparkContext和主体程序
A：driver部分 driver部分主要是对SparkContext进行配置、初始化以及关闭。初始化SparkContext是为了构建Spark应用程序的运行环境，在初始化SparkContext，要先导入一些Spark的类和隐式转换；在executor部分运行完毕后，需要将SparkContext关闭。
B：executor部分 Spark应用程序的executor部分是对数据的处理，数据分三种：
原生数据 包含输入的数据和输出的数据。
输入原生数据  scala集合数据集，如Array(1,2,3,4,5)，Spark使用parallelize方法转换成RDD。 hadoop数据集，Spark支持存储在hadoop上的文件和hadoop支持的其他文件系统，如本地文件、HBase、SequenceFile和Hadoop的输入格式。例如Spark使用txtFile方法可以将本地文件或HDFS文件转换成RDD.  输出数据  生成Scala标量数据，如count（返回RDD中元素的个数）、reduce、fold/aggregate；返回几个标量，如take（返回前几个元素）。 生成Scala集合数据集，如collect（把RDD中的所有元素倒入 Scala集合类型）、lookup（查找对应key的所有值）。 生成hadoop数据集，如saveAsTextFile、saveAsSequenceFile  RDD(Resilient Distributed Datasets) 是一个容错的、并行的数据结构，可以让用户显式地将数据存储到磁盘和内存中，并能控制数据的分区。同时，RDD还提供了一组丰富的操作来操作这些数据。在这些操作中，诸如map、flatMap、filter等转换操作实现了monad模式，很好地契合了Scala的集合操作。除此之外，RDD还提供了诸如join、groupBy、reduceByKey等更为方便的操作（注意，reduceByKey是action，而非transformation），以支持常见的数据运算。 RDD作为数据结构，本质上是一个只读的分区记录集合。一个RDD可以包含多个分区，每个分区就是一个dataset片段。RDD可以相互依赖。如果RDD的每个分区最多只能被一个Child RDD的一个分区使用，则称之为narrow dependency；若多个Child RDD分区都可以依赖，则称之为wide dependency。不同的操作依据其特性，可能会产生不同的依赖。例如map操作会产生narrow dependency，而join操作则产生wide dependency。"><link rel=stylesheet href=https://mtunique.com/css/style-dark.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://mtunique.com/images/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-65601165-1','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://mtunique.com/posts/tornado_application/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i></a></li><li><a class=icon href=https://mtunique.com/posts/linux_userspace/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover="$('#i-next').toggle()" onmouseout="$('#i-next').toggle()"></i></a></li><li><a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&text=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&is_video=false&description=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5&body=Check out this article: https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&name=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5&description=%e4%bb%a3%e7%a0%81%e9%87%8f%20Spark%3a%2020%2c000%c2%a0LOC%0aHadoop%201.0%3a%2090%2c000%c2%a0LOC%0aHadoop%202.0%3a%20220%2c000%c2%a0LOC%0a%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%20RDD%c2%a0-%20resillient%20distributed%20dataset%c2%a0%e5%bc%b9%e6%80%a7%e5%88%86%e5%b8%83%e5%bc%8f%e6%95%b0%e6%8d%ae%e9%9b%86%0aOperation%c2%a0-%20%e4%bd%9c%e7%94%a8%e4%ba%8eRDD%e7%9a%84%e5%90%84%e7%a7%8d%e6%93%8d%e4%bd%9c%e5%88%86%e4%b8%batransformation%e5%92%8caction%0aJob%c2%a0-%20%e4%bd%9c%e4%b8%9a%ef%bc%8c%e4%b8%80%e4%b8%aaJOB%e5%8c%85%e5%90%ab%e5%a4%9a%e4%b8%aaRDD%e5%8f%8a%e4%bd%9c%e7%94%a8%e4%ba%8e%e7%9b%b8%e5%ba%94RDD%e4%b8%8a%e7%9a%84%e5%90%84%e7%a7%8doperation%0aStage%c2%a0-%c2%a0%e4%b8%80%e4%b8%aa%e4%bd%9c%e4%b8%9a%e5%88%86%e4%b8%ba%e5%a4%9a%e4%b8%aa%e9%98%b6%e6%ae%b5%0aPartition%c2%a0-%20%e6%95%b0%e6%8d%ae%e5%88%86%e5%8c%ba%ef%bc%8c%20%e4%b8%80%e4%b8%aaRDD%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae%e5%8f%af%e4%bb%a5%e5%88%86%e6%88%90%e5%a4%9a%e4%b8%aa%e4%b8%8d%e5%90%8c%e7%9a%84%e5%8c%ba%0aDAG%c2%a0-%20Directed%20Acycle%20graph%2c%20%e6%9c%89%e5%90%91%e6%97%a0%e7%8e%af%e5%9b%be%ef%bc%8c%e5%8f%8d%e5%ba%94RDD%e4%b9%8b%e9%97%b4%e7%9a%84%e4%be%9d%e8%b5%96%e5%85%b3%e7%b3%bb%0aNarrow%20dependency%c2%a0-%20%e7%aa%84%e4%be%9d%e8%b5%96%ef%bc%8c%e5%ad%90RDD%e4%be%9d%e8%b5%96%e4%ba%8e%e7%88%b6RDD%e4%b8%ad%e5%9b%ba%e5%ae%9a%e7%9a%84data%c2%a0partition%0aWide%20Dependency%c2%a0-%20%e5%ae%bd%e4%be%9d%e8%b5%96%ef%bc%8c%e5%ad%90RDD%e5%af%b9%e7%88%b6RDD%e4%b8%ad%e7%9a%84%e6%89%80%e6%9c%89data%c2%a0partition%e9%83%bd%e6%9c%89%e4%be%9d%e8%b5%96%0aCaching%20Managenment%c2%a0-%20%e7%bc%93%e5%ad%98%e7%ae%a1%e7%90%86%ef%bc%8c%e5%af%b9RDD%e7%9a%84%e4%b8%ad%e9%97%b4%e8%ae%a1%e7%ae%97%e7%bb%93%e6%9e%9c%e8%bf%9b%e8%a1%8c%e7%bc%93%e5%ad%98%e7%ae%a1%e7%90%86%e4%bb%a5%e5%8a%a0%e5%bf%ab%e6%95%b4%e4%bd%93%e7%9a%84%e5%a4%84%e7%90%86%e9%80%9f%e5%ba%a6%0a%e8%bf%99%e4%ba%9b%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%e4%bc%9a%e5%8f%8d%e5%a4%8d%e6%8f%90%e5%88%b0%0a%e7%bc%96%e7%a8%8b%e6%a8%a1%e5%9e%8b%20Spark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%8f%af%e5%88%86%e4%b8%a4%e9%83%a8%e5%88%86%ef%bc%9adriver%e9%83%a8%e5%88%86%e5%92%8cexecutor%e9%83%a8%e5%88%86%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%e5%92%8c%e4%b8%bb%e4%bd%93%e7%a8%8b%e5%ba%8f%0aA%ef%bc%9adriver%e9%83%a8%e5%88%86%20driver%e9%83%a8%e5%88%86%e4%b8%bb%e8%a6%81%e6%98%af%e5%af%b9SparkContext%e8%bf%9b%e8%a1%8c%e9%85%8d%e7%bd%ae%e3%80%81%e5%88%9d%e5%a7%8b%e5%8c%96%e4%bb%a5%e5%8f%8a%e5%85%b3%e9%97%ad%e3%80%82%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%e6%98%af%e4%b8%ba%e4%ba%86%e6%9e%84%e5%bb%baSpark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84%e8%bf%90%e8%a1%8c%e7%8e%af%e5%a2%83%ef%bc%8c%e5%9c%a8%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%ef%bc%8c%e8%a6%81%e5%85%88%e5%af%bc%e5%85%a5%e4%b8%80%e4%ba%9bSpark%e7%9a%84%e7%b1%bb%e5%92%8c%e9%9a%90%e5%bc%8f%e8%bd%ac%e6%8d%a2%ef%bc%9b%e5%9c%a8executor%e9%83%a8%e5%88%86%e8%bf%90%e8%a1%8c%e5%ae%8c%e6%af%95%e5%90%8e%ef%bc%8c%e9%9c%80%e8%a6%81%e5%b0%86SparkContext%e5%85%b3%e9%97%ad%e3%80%82%0aB%ef%bc%9aexecutor%e9%83%a8%e5%88%86%20Spark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84executor%e9%83%a8%e5%88%86%e6%98%af%e5%af%b9%e6%95%b0%e6%8d%ae%e7%9a%84%e5%a4%84%e7%90%86%ef%bc%8c%e6%95%b0%e6%8d%ae%e5%88%86%e4%b8%89%e7%a7%8d%ef%bc%9a%0a%e5%8e%9f%e7%94%9f%e6%95%b0%e6%8d%ae%20%e5%8c%85%e5%90%ab%e8%be%93%e5%85%a5%e7%9a%84%e6%95%b0%e6%8d%ae%e5%92%8c%e8%be%93%e5%87%ba%e7%9a%84%e6%95%b0%e6%8d%ae%e3%80%82%0a%e8%be%93%e5%85%a5%e5%8e%9f%e7%94%9f%e6%95%b0%e6%8d%ae%20%20scala%e9%9b%86%e5%90%88%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82Array%281%2c2%2c3%2c4%2c5%29%ef%bc%8cSpark%e4%bd%bf%e7%94%a8parallelize%e6%96%b9%e6%b3%95%e8%bd%ac%e6%8d%a2%e6%88%90RDD%e3%80%82%20hadoop%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8cSpark%e6%94%af%e6%8c%81%e5%ad%98%e5%82%a8%e5%9c%a8hadoop%e4%b8%8a%e7%9a%84%e6%96%87%e4%bb%b6%e5%92%8chadoop%e6%94%af%e6%8c%81%e7%9a%84%e5%85%b6%e4%bb%96%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%ef%bc%8c%e5%a6%82%e6%9c%ac%e5%9c%b0%e6%96%87%e4%bb%b6%e3%80%81HBase%e3%80%81SequenceFile%e5%92%8cHadoop%e7%9a%84%e8%be%93%e5%85%a5%e6%a0%bc%e5%bc%8f%e3%80%82%e4%be%8b%e5%a6%82Spark%e4%bd%bf%e7%94%a8txtFile%e6%96%b9%e6%b3%95%e5%8f%af%e4%bb%a5%e5%b0%86%e6%9c%ac%e5%9c%b0%e6%96%87%e4%bb%b6%e6%88%96HDFS%e6%96%87%e4%bb%b6%e8%bd%ac%e6%8d%a2%e6%88%90RDD.%20%20%e8%be%93%e5%87%ba%e6%95%b0%e6%8d%ae%20%20%e7%94%9f%e6%88%90Scala%e6%a0%87%e9%87%8f%e6%95%b0%e6%8d%ae%ef%bc%8c%e5%a6%82count%ef%bc%88%e8%bf%94%e5%9b%9eRDD%e4%b8%ad%e5%85%83%e7%b4%a0%e7%9a%84%e4%b8%aa%e6%95%b0%ef%bc%89%e3%80%81reduce%e3%80%81fold%2faggregate%ef%bc%9b%e8%bf%94%e5%9b%9e%e5%87%a0%e4%b8%aa%e6%a0%87%e9%87%8f%ef%bc%8c%e5%a6%82take%ef%bc%88%e8%bf%94%e5%9b%9e%e5%89%8d%e5%87%a0%e4%b8%aa%e5%85%83%e7%b4%a0%ef%bc%89%e3%80%82%20%e7%94%9f%e6%88%90Scala%e9%9b%86%e5%90%88%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82collect%ef%bc%88%e6%8a%8aRDD%e4%b8%ad%e7%9a%84%e6%89%80%e6%9c%89%e5%85%83%e7%b4%a0%e5%80%92%e5%85%a5%c2%a0Scala%e9%9b%86%e5%90%88%e7%b1%bb%e5%9e%8b%ef%bc%89%e3%80%81lookup%ef%bc%88%e6%9f%a5%e6%89%be%e5%af%b9%e5%ba%94key%e7%9a%84%e6%89%80%e6%9c%89%e5%80%bc%ef%bc%89%e3%80%82%20%e7%94%9f%e6%88%90hadoop%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82saveAsTextFile%e3%80%81saveAsSequenceFile%20%20RDD%28Resilient%20Distributed%c2%a0Datasets%29%20%e6%98%af%e4%b8%80%e4%b8%aa%e5%ae%b9%e9%94%99%e7%9a%84%e3%80%81%e5%b9%b6%e8%a1%8c%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e5%8f%af%e4%bb%a5%e8%ae%a9%e7%94%a8%e6%88%b7%e6%98%be%e5%bc%8f%e5%9c%b0%e5%b0%86%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%e5%88%b0%e7%a3%81%e7%9b%98%e5%92%8c%e5%86%85%e5%ad%98%e4%b8%ad%ef%bc%8c%e5%b9%b6%e8%83%bd%e6%8e%a7%e5%88%b6%e6%95%b0%e6%8d%ae%e7%9a%84%e5%88%86%e5%8c%ba%e3%80%82%e5%90%8c%e6%97%b6%ef%bc%8cRDD%e8%bf%98%e6%8f%90%e4%be%9b%e4%ba%86%e4%b8%80%e7%bb%84%e4%b8%b0%e5%af%8c%e7%9a%84%e6%93%8d%e4%bd%9c%e6%9d%a5%e6%93%8d%e4%bd%9c%e8%bf%99%e4%ba%9b%e6%95%b0%e6%8d%ae%e3%80%82%e5%9c%a8%e8%bf%99%e4%ba%9b%e6%93%8d%e4%bd%9c%e4%b8%ad%ef%bc%8c%e8%af%b8%e5%a6%82map%e3%80%81flatMap%e3%80%81filter%e7%ad%89%e8%bd%ac%e6%8d%a2%e6%93%8d%e4%bd%9c%e5%ae%9e%e7%8e%b0%e4%ba%86monad%e6%a8%a1%e5%bc%8f%ef%bc%8c%e5%be%88%e5%a5%bd%e5%9c%b0%e5%a5%91%e5%90%88%e4%ba%86Scala%e7%9a%84%e9%9b%86%e5%90%88%e6%93%8d%e4%bd%9c%e3%80%82%e9%99%a4%e6%ad%a4%e4%b9%8b%e5%a4%96%ef%bc%8cRDD%e8%bf%98%e6%8f%90%e4%be%9b%e4%ba%86%e8%af%b8%e5%a6%82join%e3%80%81groupBy%e3%80%81reduceByKey%e7%ad%89%e6%9b%b4%e4%b8%ba%e6%96%b9%e4%be%bf%e7%9a%84%e6%93%8d%e4%bd%9c%ef%bc%88%e6%b3%a8%e6%84%8f%ef%bc%8creduceByKey%e6%98%afaction%ef%bc%8c%e8%80%8c%e9%9d%9etransformation%ef%bc%89%ef%bc%8c%e4%bb%a5%e6%94%af%e6%8c%81%e5%b8%b8%e8%a7%81%e7%9a%84%e6%95%b0%e6%8d%ae%e8%bf%90%e7%ae%97%e3%80%82%c2%a0RDD%e4%bd%9c%e4%b8%ba%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e6%9c%ac%e8%b4%a8%e4%b8%8a%e6%98%af%e4%b8%80%e4%b8%aa%e5%8f%aa%e8%af%bb%e7%9a%84%e5%88%86%e5%8c%ba%e8%ae%b0%e5%bd%95%e9%9b%86%e5%90%88%e3%80%82%e4%b8%80%e4%b8%aaRDD%e5%8f%af%e4%bb%a5%e5%8c%85%e5%90%ab%e5%a4%9a%e4%b8%aa%e5%88%86%e5%8c%ba%ef%bc%8c%e6%af%8f%e4%b8%aa%e5%88%86%e5%8c%ba%e5%b0%b1%e6%98%af%e4%b8%80%e4%b8%aadataset%e7%89%87%e6%ae%b5%e3%80%82RDD%e5%8f%af%e4%bb%a5%e7%9b%b8%e4%ba%92%e4%be%9d%e8%b5%96%e3%80%82%e5%a6%82%e6%9e%9cRDD%e7%9a%84%e6%af%8f%e4%b8%aa%e5%88%86%e5%8c%ba%e6%9c%80%e5%a4%9a%e5%8f%aa%e8%83%bd%e8%a2%ab%e4%b8%80%e4%b8%aaChild%c2%a0RDD%e7%9a%84%e4%b8%80%e4%b8%aa%e5%88%86%e5%8c%ba%e4%bd%bf%e7%94%a8%ef%bc%8c%e5%88%99%e7%a7%b0%e4%b9%8b%e4%b8%banarrow%20dependency%ef%bc%9b%e8%8b%a5%e5%a4%9a%e4%b8%aaChild%c2%a0RDD%e5%88%86%e5%8c%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e4%be%9d%e8%b5%96%ef%bc%8c%e5%88%99%e7%a7%b0%e4%b9%8b%e4%b8%bawide%20dependency%e3%80%82%e4%b8%8d%e5%90%8c%e7%9a%84%e6%93%8d%e4%bd%9c%e4%be%9d%e6%8d%ae%e5%85%b6%e7%89%b9%e6%80%a7%ef%bc%8c%e5%8f%af%e8%83%bd%e4%bc%9a%e4%ba%a7%e7%94%9f%e4%b8%8d%e5%90%8c%e7%9a%84%e4%be%9d%e8%b5%96%e3%80%82%e4%be%8b%e5%a6%82map%e6%93%8d%e4%bd%9c%e4%bc%9a%e4%ba%a7%e7%94%9fnarrow%20dependency%ef%bc%8c%e8%80%8cjoin%e6%93%8d%e4%bd%9c%e5%88%99%e4%ba%a7%e7%94%9fwide%20dependency%e3%80%82" aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&t=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#代码量>代码量</a></li><li><a href=#基本概念>基本概念</a></li><li><a href=#编程模型>编程模型</a><ul><li><a href=#adriver部分>A：driver部分</a></li><li><a href=#bexecutor部分>B：executor部分</a><ul><li><a href=#原生数据>原生数据</a></li><li><a href=#rddresilient-distributeddatasets>RDD(Resilient Distributed Datasets)</a></li></ul></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">【Spark笔记】基本概念</h1><div class=meta><div class=postdate><time datetime="2014-11-28 13:30:27 +0800 +0800" itemprop=datePublished>2014-11-28</time></div><div class=article-read-time><i class="far fa-clock"></i>
7 minute read</div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/big-data rel=tag>big-data</a>
,
<a class=tag-link href=/tags/spark rel=tag>spark</a></div></div></header><div class=content itemprop=articleBody><h2 id=代码量>代码量</h2><p>Spark: 20,000 LOC</p><p>Hadoop 1.0: 90,000 LOC</p><p>Hadoop 2.0: 220,000 LOC</p><p><img src=https://dn-mtunique.qbox.me/sparkCodeSize.png alt=pic></p><h2 id=基本概念>基本概念</h2><p><code>RDD</code> - resillient distributed dataset 弹性分布式数据集</p><p><code>Operation</code> - 作用于RDD的各种操作分为transformation和action</p><p><code>Job</code> - 作业，一个JOB包含多个RDD及作用于相应RDD上的各种operation</p><p><code>Stage</code> - 一个作业分为多个阶段</p><p><code>Partition</code> - 数据分区， 一个RDD中的数据可以分成多个不同的区</p><p><code>DAG</code> - Directed Acycle graph, 有向无环图，反应RDD之间的依赖关系</p><p><code>Narrow dependency</code> - 窄依赖，子RDD依赖于父RDD中固定的data partition</p><p><code>Wide Dependency</code> - 宽依赖，子RDD对父RDD中的所有data partition都有依赖</p><p><code>Caching Managenment</code> - 缓存管理，对RDD的中间计算结果进行缓存管理以加快整体的处理速度</p><p>这些基本概念会反复提到</p><h2 id=编程模型>编程模型</h2><p>Spark应用程序可分两部分：driver部分和executor部分初始化SparkContext和主体程序</p><h3 id=adriver部分>A：driver部分</h3><p>driver部分主要是对SparkContext进行配置、初始化以及关闭。初始化SparkContext是为了构建Spark应用程序的运行环境，在初始化SparkContext，要先导入一些Spark的类和隐式转换；在executor部分运行完毕后，需要将SparkContext关闭。</p><h3 id=bexecutor部分>B：executor部分</h3><p>Spark应用程序的executor部分是对数据的处理，数据分三种：</p><h4 id=原生数据>原生数据</h4><p>包含输入的数据和输出的数据。</p><h5 id=输入原生数据>输入原生数据</h5><ol><li>scala集合数据集，如Array(1,2,3,4,5)，Spark使用parallelize方法转换成RDD。</li><li>hadoop数据集，Spark支持存储在hadoop上的文件和hadoop支持的其他文件系统，如本地文件、HBase、SequenceFile和Hadoop的输入格式。例如Spark使用txtFile方法可以将本地文件或HDFS文件转换成RDD.</li></ol><h5 id=输出数据>输出数据</h5><ol><li>生成Scala标量数据，如count（返回RDD中元素的个数）、reduce、fold/aggregate；返回几个标量，如take（返回前几个元素）。</li><li>生成Scala集合数据集，如collect（把RDD中的所有元素倒入 Scala集合类型）、lookup（查找对应key的所有值）。</li><li>生成hadoop数据集，如saveAsTextFile、saveAsSequenceFile</li></ol><h4 id=rddresilient-distributeddatasets>RDD(Resilient Distributed Datasets)</h4><p>是一个容错的、并行的数据结构，可以让用户显式地将数据存储到磁盘和内存中，并能控制数据的分区。同时，RDD还提供了一组丰富的操作来操作这些数据。在这些操作中，诸如map、flatMap、filter等转换操作实现了monad模式，很好地契合了Scala的集合操作。除此之外，RDD还提供了诸如join、groupBy、reduceByKey等更为方便的操作（注意，reduceByKey是action，而非transformation），以支持常见的数据运算。 RDD作为数据结构，本质上是一个只读的分区记录集合。一个RDD可以包含多个分区，每个分区就是一个dataset片段。RDD可以相互依赖。如果RDD的每个分区最多只能被一个Child RDD的一个分区使用，则称之为narrow dependency；若多个Child RDD分区都可以依赖，则称之为wide dependency。不同的操作依据其特性，可能会产生不同的依赖。例如map操作会产生narrow dependency，而join操作则产生wide dependency。</p><h5 id=主要部分组成>主要部分组成</h5><ol><li><code>partitions</code> — partition集合，一个RDD中有多少data partition</li><li><code>dependencies</code> — RDD依赖关系</li><li><code>compute(parition)</code>— 对于给定的数据集，需要作哪些计算</li><li><code>preferredLocations</code> — 对于data partition的位置偏好</li><li><code>partitioner</code> — 对于计算出来的数据结果如何分发</li></ol></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var a=document.createElement('script'),b;a.type='text/javascript',a.async=!0,b='mtunique',a.src='//'+b+'.disqus.com/embed.js',(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(a)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#代码量>代码量</a></li><li><a href=#基本概念>基本概念</a></li><li><a href=#编程模型>编程模型</a><ul><li><a href=#adriver部分>A：driver部分</a></li><li><a href=#bexecutor部分>B：executor部分</a><ul><li><a href=#原生数据>原生数据</a></li><li><a href=#rddresilient-distributeddatasets>RDD(Resilient Distributed Datasets)</a></li></ul></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&text=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&is_video=false&description=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5&body=Check out this article: https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&title=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&name=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5&description=%e4%bb%a3%e7%a0%81%e9%87%8f%20Spark%3a%2020%2c000%c2%a0LOC%0aHadoop%201.0%3a%2090%2c000%c2%a0LOC%0aHadoop%202.0%3a%20220%2c000%c2%a0LOC%0a%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%20RDD%c2%a0-%20resillient%20distributed%20dataset%c2%a0%e5%bc%b9%e6%80%a7%e5%88%86%e5%b8%83%e5%bc%8f%e6%95%b0%e6%8d%ae%e9%9b%86%0aOperation%c2%a0-%20%e4%bd%9c%e7%94%a8%e4%ba%8eRDD%e7%9a%84%e5%90%84%e7%a7%8d%e6%93%8d%e4%bd%9c%e5%88%86%e4%b8%batransformation%e5%92%8caction%0aJob%c2%a0-%20%e4%bd%9c%e4%b8%9a%ef%bc%8c%e4%b8%80%e4%b8%aaJOB%e5%8c%85%e5%90%ab%e5%a4%9a%e4%b8%aaRDD%e5%8f%8a%e4%bd%9c%e7%94%a8%e4%ba%8e%e7%9b%b8%e5%ba%94RDD%e4%b8%8a%e7%9a%84%e5%90%84%e7%a7%8doperation%0aStage%c2%a0-%c2%a0%e4%b8%80%e4%b8%aa%e4%bd%9c%e4%b8%9a%e5%88%86%e4%b8%ba%e5%a4%9a%e4%b8%aa%e9%98%b6%e6%ae%b5%0aPartition%c2%a0-%20%e6%95%b0%e6%8d%ae%e5%88%86%e5%8c%ba%ef%bc%8c%20%e4%b8%80%e4%b8%aaRDD%e4%b8%ad%e7%9a%84%e6%95%b0%e6%8d%ae%e5%8f%af%e4%bb%a5%e5%88%86%e6%88%90%e5%a4%9a%e4%b8%aa%e4%b8%8d%e5%90%8c%e7%9a%84%e5%8c%ba%0aDAG%c2%a0-%20Directed%20Acycle%20graph%2c%20%e6%9c%89%e5%90%91%e6%97%a0%e7%8e%af%e5%9b%be%ef%bc%8c%e5%8f%8d%e5%ba%94RDD%e4%b9%8b%e9%97%b4%e7%9a%84%e4%be%9d%e8%b5%96%e5%85%b3%e7%b3%bb%0aNarrow%20dependency%c2%a0-%20%e7%aa%84%e4%be%9d%e8%b5%96%ef%bc%8c%e5%ad%90RDD%e4%be%9d%e8%b5%96%e4%ba%8e%e7%88%b6RDD%e4%b8%ad%e5%9b%ba%e5%ae%9a%e7%9a%84data%c2%a0partition%0aWide%20Dependency%c2%a0-%20%e5%ae%bd%e4%be%9d%e8%b5%96%ef%bc%8c%e5%ad%90RDD%e5%af%b9%e7%88%b6RDD%e4%b8%ad%e7%9a%84%e6%89%80%e6%9c%89data%c2%a0partition%e9%83%bd%e6%9c%89%e4%be%9d%e8%b5%96%0aCaching%20Managenment%c2%a0-%20%e7%bc%93%e5%ad%98%e7%ae%a1%e7%90%86%ef%bc%8c%e5%af%b9RDD%e7%9a%84%e4%b8%ad%e9%97%b4%e8%ae%a1%e7%ae%97%e7%bb%93%e6%9e%9c%e8%bf%9b%e8%a1%8c%e7%bc%93%e5%ad%98%e7%ae%a1%e7%90%86%e4%bb%a5%e5%8a%a0%e5%bf%ab%e6%95%b4%e4%bd%93%e7%9a%84%e5%a4%84%e7%90%86%e9%80%9f%e5%ba%a6%0a%e8%bf%99%e4%ba%9b%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5%e4%bc%9a%e5%8f%8d%e5%a4%8d%e6%8f%90%e5%88%b0%0a%e7%bc%96%e7%a8%8b%e6%a8%a1%e5%9e%8b%20Spark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e5%8f%af%e5%88%86%e4%b8%a4%e9%83%a8%e5%88%86%ef%bc%9adriver%e9%83%a8%e5%88%86%e5%92%8cexecutor%e9%83%a8%e5%88%86%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%e5%92%8c%e4%b8%bb%e4%bd%93%e7%a8%8b%e5%ba%8f%0aA%ef%bc%9adriver%e9%83%a8%e5%88%86%20driver%e9%83%a8%e5%88%86%e4%b8%bb%e8%a6%81%e6%98%af%e5%af%b9SparkContext%e8%bf%9b%e8%a1%8c%e9%85%8d%e7%bd%ae%e3%80%81%e5%88%9d%e5%a7%8b%e5%8c%96%e4%bb%a5%e5%8f%8a%e5%85%b3%e9%97%ad%e3%80%82%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%e6%98%af%e4%b8%ba%e4%ba%86%e6%9e%84%e5%bb%baSpark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84%e8%bf%90%e8%a1%8c%e7%8e%af%e5%a2%83%ef%bc%8c%e5%9c%a8%e5%88%9d%e5%a7%8b%e5%8c%96SparkContext%ef%bc%8c%e8%a6%81%e5%85%88%e5%af%bc%e5%85%a5%e4%b8%80%e4%ba%9bSpark%e7%9a%84%e7%b1%bb%e5%92%8c%e9%9a%90%e5%bc%8f%e8%bd%ac%e6%8d%a2%ef%bc%9b%e5%9c%a8executor%e9%83%a8%e5%88%86%e8%bf%90%e8%a1%8c%e5%ae%8c%e6%af%95%e5%90%8e%ef%bc%8c%e9%9c%80%e8%a6%81%e5%b0%86SparkContext%e5%85%b3%e9%97%ad%e3%80%82%0aB%ef%bc%9aexecutor%e9%83%a8%e5%88%86%20Spark%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e7%9a%84executor%e9%83%a8%e5%88%86%e6%98%af%e5%af%b9%e6%95%b0%e6%8d%ae%e7%9a%84%e5%a4%84%e7%90%86%ef%bc%8c%e6%95%b0%e6%8d%ae%e5%88%86%e4%b8%89%e7%a7%8d%ef%bc%9a%0a%e5%8e%9f%e7%94%9f%e6%95%b0%e6%8d%ae%20%e5%8c%85%e5%90%ab%e8%be%93%e5%85%a5%e7%9a%84%e6%95%b0%e6%8d%ae%e5%92%8c%e8%be%93%e5%87%ba%e7%9a%84%e6%95%b0%e6%8d%ae%e3%80%82%0a%e8%be%93%e5%85%a5%e5%8e%9f%e7%94%9f%e6%95%b0%e6%8d%ae%20%20scala%e9%9b%86%e5%90%88%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82Array%281%2c2%2c3%2c4%2c5%29%ef%bc%8cSpark%e4%bd%bf%e7%94%a8parallelize%e6%96%b9%e6%b3%95%e8%bd%ac%e6%8d%a2%e6%88%90RDD%e3%80%82%20hadoop%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8cSpark%e6%94%af%e6%8c%81%e5%ad%98%e5%82%a8%e5%9c%a8hadoop%e4%b8%8a%e7%9a%84%e6%96%87%e4%bb%b6%e5%92%8chadoop%e6%94%af%e6%8c%81%e7%9a%84%e5%85%b6%e4%bb%96%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%ef%bc%8c%e5%a6%82%e6%9c%ac%e5%9c%b0%e6%96%87%e4%bb%b6%e3%80%81HBase%e3%80%81SequenceFile%e5%92%8cHadoop%e7%9a%84%e8%be%93%e5%85%a5%e6%a0%bc%e5%bc%8f%e3%80%82%e4%be%8b%e5%a6%82Spark%e4%bd%bf%e7%94%a8txtFile%e6%96%b9%e6%b3%95%e5%8f%af%e4%bb%a5%e5%b0%86%e6%9c%ac%e5%9c%b0%e6%96%87%e4%bb%b6%e6%88%96HDFS%e6%96%87%e4%bb%b6%e8%bd%ac%e6%8d%a2%e6%88%90RDD.%20%20%e8%be%93%e5%87%ba%e6%95%b0%e6%8d%ae%20%20%e7%94%9f%e6%88%90Scala%e6%a0%87%e9%87%8f%e6%95%b0%e6%8d%ae%ef%bc%8c%e5%a6%82count%ef%bc%88%e8%bf%94%e5%9b%9eRDD%e4%b8%ad%e5%85%83%e7%b4%a0%e7%9a%84%e4%b8%aa%e6%95%b0%ef%bc%89%e3%80%81reduce%e3%80%81fold%2faggregate%ef%bc%9b%e8%bf%94%e5%9b%9e%e5%87%a0%e4%b8%aa%e6%a0%87%e9%87%8f%ef%bc%8c%e5%a6%82take%ef%bc%88%e8%bf%94%e5%9b%9e%e5%89%8d%e5%87%a0%e4%b8%aa%e5%85%83%e7%b4%a0%ef%bc%89%e3%80%82%20%e7%94%9f%e6%88%90Scala%e9%9b%86%e5%90%88%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82collect%ef%bc%88%e6%8a%8aRDD%e4%b8%ad%e7%9a%84%e6%89%80%e6%9c%89%e5%85%83%e7%b4%a0%e5%80%92%e5%85%a5%c2%a0Scala%e9%9b%86%e5%90%88%e7%b1%bb%e5%9e%8b%ef%bc%89%e3%80%81lookup%ef%bc%88%e6%9f%a5%e6%89%be%e5%af%b9%e5%ba%94key%e7%9a%84%e6%89%80%e6%9c%89%e5%80%bc%ef%bc%89%e3%80%82%20%e7%94%9f%e6%88%90hadoop%e6%95%b0%e6%8d%ae%e9%9b%86%ef%bc%8c%e5%a6%82saveAsTextFile%e3%80%81saveAsSequenceFile%20%20RDD%28Resilient%20Distributed%c2%a0Datasets%29%20%e6%98%af%e4%b8%80%e4%b8%aa%e5%ae%b9%e9%94%99%e7%9a%84%e3%80%81%e5%b9%b6%e8%a1%8c%e7%9a%84%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e5%8f%af%e4%bb%a5%e8%ae%a9%e7%94%a8%e6%88%b7%e6%98%be%e5%bc%8f%e5%9c%b0%e5%b0%86%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%e5%88%b0%e7%a3%81%e7%9b%98%e5%92%8c%e5%86%85%e5%ad%98%e4%b8%ad%ef%bc%8c%e5%b9%b6%e8%83%bd%e6%8e%a7%e5%88%b6%e6%95%b0%e6%8d%ae%e7%9a%84%e5%88%86%e5%8c%ba%e3%80%82%e5%90%8c%e6%97%b6%ef%bc%8cRDD%e8%bf%98%e6%8f%90%e4%be%9b%e4%ba%86%e4%b8%80%e7%bb%84%e4%b8%b0%e5%af%8c%e7%9a%84%e6%93%8d%e4%bd%9c%e6%9d%a5%e6%93%8d%e4%bd%9c%e8%bf%99%e4%ba%9b%e6%95%b0%e6%8d%ae%e3%80%82%e5%9c%a8%e8%bf%99%e4%ba%9b%e6%93%8d%e4%bd%9c%e4%b8%ad%ef%bc%8c%e8%af%b8%e5%a6%82map%e3%80%81flatMap%e3%80%81filter%e7%ad%89%e8%bd%ac%e6%8d%a2%e6%93%8d%e4%bd%9c%e5%ae%9e%e7%8e%b0%e4%ba%86monad%e6%a8%a1%e5%bc%8f%ef%bc%8c%e5%be%88%e5%a5%bd%e5%9c%b0%e5%a5%91%e5%90%88%e4%ba%86Scala%e7%9a%84%e9%9b%86%e5%90%88%e6%93%8d%e4%bd%9c%e3%80%82%e9%99%a4%e6%ad%a4%e4%b9%8b%e5%a4%96%ef%bc%8cRDD%e8%bf%98%e6%8f%90%e4%be%9b%e4%ba%86%e8%af%b8%e5%a6%82join%e3%80%81groupBy%e3%80%81reduceByKey%e7%ad%89%e6%9b%b4%e4%b8%ba%e6%96%b9%e4%be%bf%e7%9a%84%e6%93%8d%e4%bd%9c%ef%bc%88%e6%b3%a8%e6%84%8f%ef%bc%8creduceByKey%e6%98%afaction%ef%bc%8c%e8%80%8c%e9%9d%9etransformation%ef%bc%89%ef%bc%8c%e4%bb%a5%e6%94%af%e6%8c%81%e5%b8%b8%e8%a7%81%e7%9a%84%e6%95%b0%e6%8d%ae%e8%bf%90%e7%ae%97%e3%80%82%c2%a0RDD%e4%bd%9c%e4%b8%ba%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%ef%bc%8c%e6%9c%ac%e8%b4%a8%e4%b8%8a%e6%98%af%e4%b8%80%e4%b8%aa%e5%8f%aa%e8%af%bb%e7%9a%84%e5%88%86%e5%8c%ba%e8%ae%b0%e5%bd%95%e9%9b%86%e5%90%88%e3%80%82%e4%b8%80%e4%b8%aaRDD%e5%8f%af%e4%bb%a5%e5%8c%85%e5%90%ab%e5%a4%9a%e4%b8%aa%e5%88%86%e5%8c%ba%ef%bc%8c%e6%af%8f%e4%b8%aa%e5%88%86%e5%8c%ba%e5%b0%b1%e6%98%af%e4%b8%80%e4%b8%aadataset%e7%89%87%e6%ae%b5%e3%80%82RDD%e5%8f%af%e4%bb%a5%e7%9b%b8%e4%ba%92%e4%be%9d%e8%b5%96%e3%80%82%e5%a6%82%e6%9e%9cRDD%e7%9a%84%e6%af%8f%e4%b8%aa%e5%88%86%e5%8c%ba%e6%9c%80%e5%a4%9a%e5%8f%aa%e8%83%bd%e8%a2%ab%e4%b8%80%e4%b8%aaChild%c2%a0RDD%e7%9a%84%e4%b8%80%e4%b8%aa%e5%88%86%e5%8c%ba%e4%bd%bf%e7%94%a8%ef%bc%8c%e5%88%99%e7%a7%b0%e4%b9%8b%e4%b8%banarrow%20dependency%ef%bc%9b%e8%8b%a5%e5%a4%9a%e4%b8%aaChild%c2%a0RDD%e5%88%86%e5%8c%ba%e9%83%bd%e5%8f%af%e4%bb%a5%e4%be%9d%e8%b5%96%ef%bc%8c%e5%88%99%e7%a7%b0%e4%b9%8b%e4%b8%bawide%20dependency%e3%80%82%e4%b8%8d%e5%90%8c%e7%9a%84%e6%93%8d%e4%bd%9c%e4%be%9d%e6%8d%ae%e5%85%b6%e7%89%b9%e6%80%a7%ef%bc%8c%e5%8f%af%e8%83%bd%e4%bc%9a%e4%ba%a7%e7%94%9f%e4%b8%8d%e5%90%8c%e7%9a%84%e4%be%9d%e8%b5%96%e3%80%82%e4%be%8b%e5%a6%82map%e6%93%8d%e4%bd%9c%e4%bc%9a%e4%ba%a7%e7%94%9fnarrow%20dependency%ef%bc%8c%e8%80%8cjoin%e6%93%8d%e4%bd%9c%e5%88%99%e4%ba%a7%e7%94%9fwide%20dependency%e3%80%82" aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fmtunique.com%2fposts%2fspark_base%2f&t=%e3%80%90Spark%e7%ac%94%e8%ae%b0%e3%80%91%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2021 mtunique</div><div class=footer-right><nav><ul><li><a href=/>Home</a></li><li><a href=/posts>Writings</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/lib/font-awesome/css/all.min.css><script src=/lib/jquery/jquery.min.js></script><script src=/js/main.js></script></html>